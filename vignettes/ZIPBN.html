<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Junsouk Choi" />


<title>ZIPBN: Zero-inflated Poisson Bayesian Networks for Zero-inflated Count Data</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">ZIPBN: Zero-inflated Poisson Bayesian Networks for Zero-inflated Count Data</h1>
<h4 class="author">Junsouk Choi</h4>
<h4 class="date">Dec 7, 2019</h4>



<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>In this vignette, we will give a tutorial on using <code>ZIPBN</code>. <code>ZIPBN</code> fits zero-inflated Poisson Bayesian networks (ZIPBN) for zero-inflated count data, such as scRNA-seq data, using Markov chain Monte Carlo (MCMC). The ZIPBN models deal with conditional dependencies of variables of zero-inflated count data. The model and its MCMC implementation are intermediate results of on-going work on scalable Bayesian networks for the scRNA-seq data. Therefore, any manuscripts are not available yet, which explain the ZIPBN model and how to implement it. Before showing how to use <code>ZIPBN</code> to make a network analysis on zero-inflated count data, we briefly introduce the ZIPBN model and its MCMC schema.</p>
<p> </p>
</div>
<div id="zero-inflated-poisson-bayesian-networks" class="section level1">
<h1>Zero-inflated Poisson Bayesian Networks</h1>
<p>The goal is to discover conditional dependence structures from zero-inflated count data using Bayesian networks. A Bayesian network, also known as directed acyclic graph (DAG), is a pair <span class="math inline">\(\{ V, A \}\)</span>, where <span class="math inline">\(V = \{ 1, \ldots, p \}\)</span> is a set of nodes representing random variables <span class="math inline">\(\mathbf{X} = \{ X_1, \ldots, X_p \}\)</span> and <span class="math inline">\(A = (a_{jk})\)</span> is a set of directed edges with <span class="math inline">\(a_{jk} = 1\)</span> meaning a directed edge <span class="math inline">\(k \to j\)</span> from the node <span class="math inline">\(k\)</span> to the node <span class="math inline">\(j\)</span>. We often call <span class="math inline">\(A\)</span> as the adjacency matrix. Beyesian networks allow no cycle, meaning one cannot return to the same node by following the directed edges. The acyclicity of Bayesian networks leads to a factorization of the joint distribution of <span class="math inline">\(\mathbf{X}\)</span> into a set of local distributions, <span class="math inline">\(p(\mathbf{X} | A) = \prod_{j=1}^p p(X_j | X_{pa(j)})\)</span>. Here, <span class="math inline">\(pa(j) = \{ k \in V | a_{jk} = 1 \}\)</span> is a set of parents of node <span class="math inline">\(j\)</span> and <span class="math inline">\(X_{pa(j)} = \{ X_k : k \in pa(j) \}\)</span> is a subset of random variables indexed by <span class="math inline">\(pa(j)\)</span>.</p>
<p>To deal with excessive zeros in zero-inflated count data, we model each local distribution in the factorization to be a zero-inflated Poisson model as following: <span class="math display">\[
Pr(X_j = x | \mathbf{X}_{pa(j)}) = 
\begin{cases}
\pi_j + (1 - \pi_j) Poi(0 | \mu_j) &amp; \quad \text{if} \quad x = 0 \\
(1 - \pi_j) Poi(x | \mu_j) &amp; \quad \text{if} \quad x &gt; 0.
\end{cases}
\]</span> where <span class="math inline">\(\pi_j = \text{logit}^{-1} (\sum_{k=1}^p \alpha_{jk} X_k + \delta_j)\)</span> and <span class="math inline">\(\mu_j = \text{exp} (\sum_{k = 1}^p \beta_{jk} X_k + \gamma_j)\)</span> with <span class="math inline">\(\alpha_{jk} = \beta_{jk} = 0\)</span> if <span class="math inline">\(k \notin pa(j)\)</span>. We denote the proposed ZIPBN model by <span class="math inline">\(ZIPBN(\mathbf{\alpha}, \mathbf{\beta}, \delta, \gamma)\)</span>, where parameters are <span class="math inline">\(\mathbf{\alpha} = (\alpha_{jk})\)</span>, <span class="math inline">\(\mathbf{\beta} = (\beta_{jk})\)</span>, <span class="math inline">\(\delta = (\delta_{j})\)</span>, and <span class="math inline">\(\gamma = (\gamma_{j})\)</span> with <span class="math inline">\(\alpha_{jk} = \beta_{jk} = 0\)</span> if <span class="math inline">\(k \notin pa(j)\)</span>.</p>
<p>We adopt a Bayesian inference strategy to make inference on the ZIPBN models. Inference on parameters <span class="math inline">\(\mathbf{\alpha}\)</span> and <span class="math inline">\(\mathbf{\beta}\)</span> which allows sparsity naturally leads to the selection of the effective edges. A spike-and-slab prior is imposed on each element of <span class="math inline">\(\mathbf{\alpha}\)</span> and <span class="math inline">\(\mathbf{\beta}\)</span> as following: <span class="math display">\[\begin{align*}
\alpha_{jk} | a_{jk}, \tau_\alpha &amp; \sim a_{jk} N\left(0, \tau_\alpha^{-1}\right) + (1 - a_{jk}) N\left(0, (\nu \tau_\alpha)^{-1}\right), \\
\beta_{jk} | a_{jk}, \tau_\beta &amp; \sim a_{jk} N\left(0, \tau_\beta^{-1}\right) + (1 - a_{jk}) N\left(0, (\nu\tau_\beta)^{-1}\right),
\end{align*}\]</span> where <span class="math inline">\(\nu\)</span> is sufficiently large. Notice that <span class="math inline">\(a_{jk}\)</span> represents whether an edge <span class="math inline">\(k \to j\)</span> is selected based on the data. Furthermore, we assume that <span class="math inline">\(\delta_j\)</span> and <span class="math inline">\(\gamma_j\)</span> follow Normal prior distributions with mean <span class="math inline">\(0\)</span> and precisions <span class="math inline">\(\tau_\delta\)</span> and <span class="math inline">\(\tau_\gamma\)</span> respectively. For the graph parameter <span class="math inline">\(a_{jk}\)</span>, we use a Bernoulli prior with success probability <span class="math inline">\(\rho\)</span>. The hierarchical formulation of our model is completed by assigning a Gamma prior to each of <span class="math inline">\(\tau\)</span>’s and a Beta prior to <span class="math inline">\(\rho\)</span>.</p>
<p>For posterior inference, we sample parameters from the posterior distributions using an MCMC algorithm. The MCMC algorithm updates each parameter by Gibbs sampler at each iteration. When the full conditional distribution is not available in closed form, we update it through a Metropolis step. The most difficult part of the MCMC implementation is to sample <span class="math inline">\(a_{jk}\)</span>’s, due to their ugly posterior probability space. To overcome it, we sample <span class="math inline">\(a_{jk}\)</span> jointly with <span class="math inline">\(\alpha_{jk}\)</span>, <span class="math inline">\(\beta_{jk}\)</span>, <span class="math inline">\(\delta_j\)</span>, and <span class="math inline">\(\gamma_j\)</span>. Additionally, one of two proposal strategies is chosen with probability of <span class="math inline">\(0.5\)</span>. The first one is that if there exist (or doesn’t exist) an edge <span class="math inline">\(k \to j\)</span>, a Metropolis sampler proposes addition of the edge (or deletion of the edge). The second strategy is to propose reversing the edge for a Metropolis step. This MCMC algorithm is implemented as <code>ZIPBN</code> package.</p>
<p> </p>
</div>
<div id="generating-example-data" class="section level1">
<h1>Generating Example Data</h1>
<p>We generate example data using ZIPBN models, rather than loading real data. It will be helpful to understand what the ZIPB model is, since procedure of data generation gives a clear sketch of ZIPBN models. First, we load <code>ZIPBN</code> package and randomly generate a graph. <code>igraph</code> package is also loaded to make use of its convenient functions for analyzing graph structures.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="co"># load ZIPBN package with igraph package</span></a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw">library</span>(ZIPBN)</a>
<a class="sourceLine" id="cb1-3" title="3"><span class="kw">library</span>(igraph)</a></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="co"># set random seed for reproducibility</span></a>
<a class="sourceLine" id="cb2-2" title="2"><span class="kw">set.seed</span>(<span class="dv">20191207</span>)</a>
<a class="sourceLine" id="cb2-3" title="3"></a>
<a class="sourceLine" id="cb2-4" title="4"><span class="co"># randomly generate a DAG with p nodes and p - 1 edges</span></a>
<a class="sourceLine" id="cb2-5" title="5">p =<span class="st"> </span><span class="dv">6</span></a>
<a class="sourceLine" id="cb2-6" title="6">n_edges =<span class="st"> </span>p</a>
<a class="sourceLine" id="cb2-7" title="7">A =<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, p, p)</a>
<a class="sourceLine" id="cb2-8" title="8"><span class="cf">while</span> (<span class="kw">sum</span>(A <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) <span class="op">&lt;</span><span class="st"> </span>n_edges)</a>
<a class="sourceLine" id="cb2-9" title="9">{</a>
<a class="sourceLine" id="cb2-10" title="10">   id_edge =<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">sample</span>(<span class="dv">1</span> <span class="op">:</span><span class="st"> </span>p, <span class="dv">2</span>), <span class="dt">ncol =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb2-11" title="11">   A[id_edge] =<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb2-12" title="12">   g =<span class="st"> </span><span class="kw">graph_from_adjacency_matrix</span>(<span class="kw">t</span>(A))</a>
<a class="sourceLine" id="cb2-13" title="13"></a>
<a class="sourceLine" id="cb2-14" title="14">   <span class="co"># if selected edge make a directed cycle, discard the edge </span></a>
<a class="sourceLine" id="cb2-15" title="15">   <span class="cf">if</span> (<span class="op">!</span><span class="kw">is_dag</span>(g))</a>
<a class="sourceLine" id="cb2-16" title="16">      A[id_edge] =<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb2-17" title="17">}</a>
<a class="sourceLine" id="cb2-18" title="18"></a>
<a class="sourceLine" id="cb2-19" title="19"><span class="co"># show the generated DAG</span></a>
<a class="sourceLine" id="cb2-20" title="20">A</a>
<a class="sourceLine" id="cb2-21" title="21"><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5] [,6]</span></a>
<a class="sourceLine" id="cb2-22" title="22"><span class="co">#&gt; [1,]    0    0    1    0    1    0</span></a>
<a class="sourceLine" id="cb2-23" title="23"><span class="co">#&gt; [2,]    0    0    0    0    0    1</span></a>
<a class="sourceLine" id="cb2-24" title="24"><span class="co">#&gt; [3,]    0    1    0    1    0    0</span></a>
<a class="sourceLine" id="cb2-25" title="25"><span class="co">#&gt; [4,]    0    0    0    0    0    0</span></a>
<a class="sourceLine" id="cb2-26" title="26"><span class="co">#&gt; [5,]    0    1    0    0    0    0</span></a>
<a class="sourceLine" id="cb2-27" title="27"><span class="co">#&gt; [6,]    0    0    0    0    0    0</span></a>
<a class="sourceLine" id="cb2-28" title="28"><span class="kw">plot.igraph</span>(g, <span class="dt">vertex.size =</span> <span class="dv">25</span>, <span class="dt">vertex.color =</span> <span class="st">&quot;pink&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;DAG generated with 6 nodes and 6 edges&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>A DAG with 6 nodes and 6 edges is generated. <code>graph_from_adjacency_matrix</code> function creates an <code>igraph</code> graph object from an adjacency matrix and <code>is_dag</code> function tests whether the given <code>igraph</code> graph is a DAG. The above code randomly suggests a directed edge and tests whether the suggested edge makes a directed cycle. If a directed cycle is made, we discard the proposed edge. It is repeated until the graph has the prespecified number of edges. Notice that ZIPBN models define an adjacency matrix as <span class="math inline">\(A = (a_{jk})\)</span> with <span class="math inline">\(a_{jk} = 1\)</span> if <span class="math inline">\(k \to j\)</span>, but in the case of <code>igraph</code> , <span class="math inline">\(a_{jk} = 1\)</span> if <span class="math inline">\(j \to k\)</span>. We, therefore, need to transpose our adjacency matrix before converting it to an <code>igraph</code> graph. The adjacency matrix <code>A</code> we generate is printed and its graph is plotted using <code>plot.igraph</code> function of <code>igraph</code>. We then generate data from a ZIPBN model depending on the DAG we create.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="co"># set parameters of the ZIPBN model, given DAG A</span></a>
<a class="sourceLine" id="cb3-2" title="2">alpha =<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, p, p)</a>
<a class="sourceLine" id="cb3-3" title="3">alpha[A <span class="op">==</span><span class="st"> </span><span class="dv">1</span>] =<span class="st"> </span><span class="fl">0.2</span></a>
<a class="sourceLine" id="cb3-4" title="4">beta  =<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, p, p)</a>
<a class="sourceLine" id="cb3-5" title="5">beta[A <span class="op">==</span><span class="st"> </span><span class="dv">1</span>]  =<span class="st"> </span><span class="fl">-0.2</span></a>
<a class="sourceLine" id="cb3-6" title="6">delta =<span class="st"> </span><span class="kw">rep</span>(<span class="op">-</span><span class="dv">1</span>, p)</a>
<a class="sourceLine" id="cb3-7" title="7">gamma =<span class="st"> </span><span class="kw">rep</span>(<span class="dv">2</span>, p)</a>
<a class="sourceLine" id="cb3-8" title="8"></a>
<a class="sourceLine" id="cb3-9" title="9"><span class="co"># generate data from the ZIPBN model with true parameters</span></a>
<a class="sourceLine" id="cb3-10" title="10">n =<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb3-11" title="11">x =<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, n, p)</a>
<a class="sourceLine" id="cb3-12" title="12">order_nodes =<span class="st"> </span><span class="kw">as_ids</span>(<span class="kw">topo_sort</span>(g))</a>
<a class="sourceLine" id="cb3-13" title="13">order_nodes</a>
<a class="sourceLine" id="cb3-14" title="14"><span class="co">#&gt; [1] 4 6 2 3 5 1</span></a>
<a class="sourceLine" id="cb3-15" title="15"><span class="cf">for</span> (j <span class="cf">in</span> order_nodes)</a>
<a class="sourceLine" id="cb3-16" title="16">{</a>
<a class="sourceLine" id="cb3-17" title="17">  <span class="co"># calculate pi_j</span></a>
<a class="sourceLine" id="cb3-18" title="18">  pi =<span class="st"> </span><span class="kw">exp</span>(x <span class="op">%*%</span><span class="st"> </span>alpha[j, ] <span class="op">+</span><span class="st"> </span>delta[j])</a>
<a class="sourceLine" id="cb3-19" title="19">  pi =<span class="st"> </span>pi <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>pi)</a>
<a class="sourceLine" id="cb3-20" title="20">  <span class="co"># calculate mu_j</span></a>
<a class="sourceLine" id="cb3-21" title="21">  mu =<span class="st"> </span><span class="kw">exp</span>(x <span class="op">%*%</span><span class="st"> </span>beta[j, ] <span class="op">+</span><span class="st"> </span>gamma[j])</a>
<a class="sourceLine" id="cb3-22" title="22">  <span class="co"># generate data for X_j</span></a>
<a class="sourceLine" id="cb3-23" title="23">  x[ , j] =<span class="st"> </span><span class="kw">rpois</span>(n, mu) <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">rbinom</span>(n, <span class="dv">1</span>, pi))</a>
<a class="sourceLine" id="cb3-24" title="24">}</a>
<a class="sourceLine" id="cb3-25" title="25"></a>
<a class="sourceLine" id="cb3-26" title="26"></a>
<a class="sourceLine" id="cb3-27" title="27"><span class="kw">head</span>(x)</a>
<a class="sourceLine" id="cb3-28" title="28"><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5] [,6]</span></a>
<a class="sourceLine" id="cb3-29" title="29"><span class="co">#&gt; [1,]    0    1    4    0    4    5</span></a>
<a class="sourceLine" id="cb3-30" title="30"><span class="co">#&gt; [2,]    0    0    5    0    3   11</span></a>
<a class="sourceLine" id="cb3-31" title="31"><span class="co">#&gt; [3,]    0    6    3    0    1    0</span></a>
<a class="sourceLine" id="cb3-32" title="32"><span class="co">#&gt; [4,]    0    0    1   10    7    4</span></a>
<a class="sourceLine" id="cb3-33" title="33"><span class="co">#&gt; [5,]    0    2    0    6    8    5</span></a>
<a class="sourceLine" id="cb3-34" title="34"><span class="co">#&gt; [6,]    0    0    0    9    3    0</span></a>
<a class="sourceLine" id="cb3-35" title="35"><span class="kw">mean</span>(x <span class="op">==</span><span class="st"> </span><span class="dv">0</span>)   <span class="co"># proprtion of zeros</span></a>
<a class="sourceLine" id="cb3-36" title="36"><span class="co">#&gt; [1] 0.4453333</span></a></code></pre></div>
<p>Given the generated adjacency matrix (DAG) <code>A</code>, parameters are specified for ZIPBN. If there is a directed edge <span class="math inline">\(k \to j\)</span>, the corresponding <span class="math inline">\(\alpha_{jk}\)</span> and <span class="math inline">\(\beta_{jk}\)</span> equal to 0.2 and -0.2 respectively. Otherwise, they are zeros. All <span class="math inline">\(\delta_j\)</span>’s has the value of -1, while <span class="math inline">\(\gamma_j\)</span>’s are 2. We draw 1000 samples from the ZIPBN model with the specified parameters. Here, some functions of <code>igraph</code> are used. <code>topo_sort</code> function orders the nodes of a DAG graph so that each node comes before all nodes to which it has edges. <code>as_ids</code> function convert a node sequence to an ordinary vector. 4, 6, 2, 3, 5, 1 are the order of our DAG and we generate data in the sequence of this order. Observe that the proportion of zeros in data is 0.4453333, which indicates the generated data are sparse with excessive zeros.</p>
<p> </p>
</div>
<div id="using-zipbn-for-example-data" class="section level1">
<h1>Using <code>ZIPBN</code> for Example Data</h1>
<p>In this section, we demonstrate how <code>ZIPBN</code> can be used to discover conditional dependence structures of variables from zero-inflated count data. <code>ZIPBN</code> consists of a function <code>mcmc_ZIPBN</code> which implements the MCMC for ZIPBN models. <code>mcmc_ZIPBN</code> needs three essential arguments <code>starting</code>, <code>tuning</code>, and <code>priors</code>.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="co"># create starting value list</span></a>
<a class="sourceLine" id="cb4-2" title="2">m =<span class="st"> </span><span class="kw">colMeans</span>(x)</a>
<a class="sourceLine" id="cb4-3" title="3">v =<span class="st"> </span><span class="kw">apply</span>(x, <span class="dv">2</span>, var)</a>
<a class="sourceLine" id="cb4-4" title="4">starting =<span class="st"> </span><span class="kw">list</span>(<span class="dt">alpha =</span> <span class="kw">matrix</span>(<span class="dv">0</span>, p, p),</a>
<a class="sourceLine" id="cb4-5" title="5">                <span class="dt">beta  =</span> <span class="kw">matrix</span>(<span class="dv">0</span>, p, p),</a>
<a class="sourceLine" id="cb4-6" title="6">                <span class="dt">delta =</span> <span class="kw">log</span>((v <span class="op">-</span><span class="st"> </span>m) <span class="op">/</span><span class="st"> </span>(m <span class="op">*</span><span class="st"> </span>m)),</a>
<a class="sourceLine" id="cb4-7" title="7">                <span class="dt">gamma =</span> <span class="kw">log</span>((v <span class="op">-</span><span class="st"> </span>m <span class="op">+</span><span class="st"> </span>m <span class="op">*</span><span class="st"> </span>m) <span class="op">/</span><span class="st"> </span>m),</a>
<a class="sourceLine" id="cb4-8" title="8">                <span class="dt">A     =</span> <span class="kw">matrix</span>(<span class="dv">0</span>, p, p),</a>
<a class="sourceLine" id="cb4-9" title="9">                <span class="dt">tau   =</span> <span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">10</span>, <span class="dv">1</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb4-10" title="10">                <span class="dt">rho   =</span> <span class="fl">0.1</span>)</a></code></pre></div>
<p><code>starting</code> is a list with each tag corresponding to a parameter name. The value portion of each tag is the parameters’ starting values for MCMC. Valid tags are alpha, beta, delta, gamma, A, tau, and rho. If you have any prior information about graph structure of your data, it would be better to incorporate the information into the starting values. We assume we know nothing about our data. The empty graph is a good choice for the starting value of A, since we believe a graph is sparse. The starting values of alpha and beta should be zero matrices accordingly. For the starting values of delta and gamma, assuming all variables are independent, we calculate the plug-in estimates for <span class="math inline">\(\delta\)</span> and <span class="math inline">\(\gamma\)</span>. Values between 1 and 10 are good enogh for Markov chains of <span class="math inline">\(\tau\)</span>’s to start. The choice of starting values of tau does not affect much to the performance of our MCMC. The value of 0.1 is reasonable for the starting value of rho, due to sparsity assumption for graph structure.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="co"># create tuning value list</span></a>
<a class="sourceLine" id="cb5-2" title="2">tuning =<span class="st"> </span><span class="kw">list</span>(<span class="dt">phi_alpha =</span> <span class="kw">c</span>(<span class="fl">1e+8</span>, <span class="dv">20</span>),</a>
<a class="sourceLine" id="cb5-3" title="3">              <span class="dt">phi_beta  =</span> <span class="kw">c</span>(<span class="fl">1e+8</span>, <span class="dv">100</span>),</a>
<a class="sourceLine" id="cb5-4" title="4">              <span class="dt">phi_delta =</span> <span class="dv">5</span>,</a>
<a class="sourceLine" id="cb5-5" title="5">              <span class="dt">phi_gamma =</span> <span class="dv">50</span>,</a>
<a class="sourceLine" id="cb5-6" title="6">              <span class="dt">phi_A     =</span> <span class="kw">c</span>(<span class="fl">1e+10</span>, <span class="dv">10</span>, <span class="dv">10</span>, <span class="dv">1</span>, <span class="dv">10</span>))</a></code></pre></div>
<p><code>tuning</code> is a list with each tag corresponding to a parameter name. The value portion of each tag defines the precision of Normal proposal distribution for Metropolis sampler. Valid tags are phi_alpha, phi_beta, phi_delta, phi_gamma, and phi_A. phi_alpha and phi_beta should be a positive vector of length 2. When a new value is proposed for each element, if there is no edge corresponding to the element, the Metropolis sampler uses the first element as the precision of the proposal distribution. Otherwise, the second element is used. phi_A must be a positive vector of length 5. Note that an element of <span class="math inline">\(A\)</span> is proposed jointly with the corresponding element of alpha, beta, delta, and gamma. The third and fourth elements are precisions of Normal proposal distributions for <span class="math inline">\(\delta\)</span> and <span class="math inline">\(\gamma\)</span>. The first element is used for proposal regarding <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span>, if deletion of an edge is proposed. The second and third elements are used to propose a new value of each element of <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span>, when proposing addition of an edge. The tuning values of phi_alpha, phi_beta, phi_delta, and phi_gamma should be chosen by monitoring the acceptance rates. The desired acceptance rate is between 25% and 60%. Furthermore, we need to set values of phi_A for the MCMC sampler to report neither too few nor too many changes of edges.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="co"># create priors list</span></a>
<a class="sourceLine" id="cb6-2" title="2">priors =<span class="st"> </span><span class="kw">list</span>(<span class="dt">nu        =</span> <span class="dv">10000</span><span class="op">^</span><span class="dv">2</span>,</a>
<a class="sourceLine" id="cb6-3" title="3">              <span class="dt">tau_alpha =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="fl">0.01</span>),</a>
<a class="sourceLine" id="cb6-4" title="4">              <span class="dt">tau_beta  =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="fl">0.01</span>),</a>
<a class="sourceLine" id="cb6-5" title="5">              <span class="dt">tau_delta =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="fl">0.01</span>),</a>
<a class="sourceLine" id="cb6-6" title="6">              <span class="dt">tau_gamma =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="fl">0.01</span>),</a>
<a class="sourceLine" id="cb6-7" title="7">              <span class="dt">rho       =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>))</a></code></pre></div>
<p><code>priors</code> is a list with each tag corresponding to a parameter name. The value portion of each tag defines hyperparameters of the priors specified for ZIPBN models Valid tags are nu, tau_alpha, tau_beta, tau_delta, tau_gamma, and rho. The value of nu controls the spike part of our spike-and-slab prior for <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span>’s. Our experiment shows that <span class="math inline">\(10000^2\)</span> or <span class="math inline">\(1000^2\)</span> gives satisfactory results. tau_alpha, tau_beta, tau_delta, are tau_gamma define hyperparameters of Gamma priors for precisions of Normal priors on ZIPBN parameters. Values of 0.01, 0.01 are most commonly used, since the hyperparameter values makes Gamma prior uninformative. rho determines hyperparameters of Beta prior on the inclusion probability of edges. We set , as it assign high probability near <span class="math inline">\(0\)</span> and we assume sparsity for graph structure.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="co"># run mcmc_ZIPBN function</span></a>
<a class="sourceLine" id="cb7-2" title="2">n_sample =<span class="st"> </span><span class="dv">5000</span></a>
<a class="sourceLine" id="cb7-3" title="3">n_burnin =<span class="st"> </span><span class="dv">2500</span></a>
<a class="sourceLine" id="cb7-4" title="4">verbose  =<span class="st"> </span><span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb7-5" title="5">n_report =<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb7-6" title="6">out =<span class="st"> </span><span class="kw">mcmc_ZIPBN</span>(x, starting, tuning, priors, n_sample, n_burnin, verbose, n_report)</a>
<a class="sourceLine" id="cb7-7" title="7"><span class="co">#&gt; An edge 6 -&gt; 2 is added </span></a>
<a class="sourceLine" id="cb7-8" title="8"><span class="co">#&gt; An edge 1 -&gt; 3 is added </span></a>
<a class="sourceLine" id="cb7-9" title="9"><span class="co">#&gt; An edge 6 -&gt; 1 is added </span></a>
<a class="sourceLine" id="cb7-10" title="10"><span class="co">#&gt; An edge 4 -&gt; 3 is added </span></a>
<a class="sourceLine" id="cb7-11" title="11"><span class="co">#&gt; An edge 2 -&gt; 3 is added </span></a>
<a class="sourceLine" id="cb7-12" title="12"><span class="co">#&gt; An edge 5 -&gt; 1 is added </span></a>
<a class="sourceLine" id="cb7-13" title="13"><span class="co">#&gt; An edge 6 -&gt; 1 is deleted </span></a>
<a class="sourceLine" id="cb7-14" title="14"><span class="co">#&gt; An edge 2 -&gt; 5 is added </span></a>
<a class="sourceLine" id="cb7-15" title="15"><span class="co">#&gt; An edge 4 -&gt; 1 is added </span></a>
<a class="sourceLine" id="cb7-16" title="16"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-17" title="17"><span class="co">#&gt; iter= 1000 </span></a>
<a class="sourceLine" id="cb7-18" title="18"><span class="co">#&gt; acceptance rates of alpha: </span></a>
<a class="sourceLine" id="cb7-19" title="19"><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5] [,6]</span></a>
<a class="sourceLine" id="cb7-20" title="20"><span class="co">#&gt; [1,]  0.0 25.5 26.7  7.3  9.2 26.1</span></a>
<a class="sourceLine" id="cb7-21" title="21"><span class="co">#&gt; [2,] 25.9  0.0 24.3 24.0 25.2  7.5</span></a>
<a class="sourceLine" id="cb7-22" title="22"><span class="co">#&gt; [3,] 16.3 18.6  0.0  8.4 25.2 25.6</span></a>
<a class="sourceLine" id="cb7-23" title="23"><span class="co">#&gt; [4,] 25.3 22.8 25.8  0.0 25.2 26.6</span></a>
<a class="sourceLine" id="cb7-24" title="24"><span class="co">#&gt; [5,] 26.0 13.3 26.6 24.7  0.0 24.8</span></a>
<a class="sourceLine" id="cb7-25" title="25"><span class="co">#&gt; [6,] 24.6 26.7 23.6 25.7 22.6  0.0</span></a>
<a class="sourceLine" id="cb7-26" title="26"><span class="co">#&gt; acceptance rates of beta: </span></a>
<a class="sourceLine" id="cb7-27" title="27"><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5] [,6]</span></a>
<a class="sourceLine" id="cb7-28" title="28"><span class="co">#&gt; [1,]  0.0 31.7 26.4  5.4 13.2 25.5</span></a>
<a class="sourceLine" id="cb7-29" title="29"><span class="co">#&gt; [2,] 23.4  0.0 26.5 25.5 26.3  9.8</span></a>
<a class="sourceLine" id="cb7-30" title="30"><span class="co">#&gt; [3,] 23.3 20.9  0.0 13.0 25.6 25.6</span></a>
<a class="sourceLine" id="cb7-31" title="31"><span class="co">#&gt; [4,] 24.8 25.0 28.5  0.0 24.7 25.6</span></a>
<a class="sourceLine" id="cb7-32" title="32"><span class="co">#&gt; [5,] 24.6 14.1 25.4 23.9  0.0 26.6</span></a>
<a class="sourceLine" id="cb7-33" title="33"><span class="co">#&gt; [6,] 24.8 25.8 24.0 25.3 24.7  0.0</span></a>
<a class="sourceLine" id="cb7-34" title="34"><span class="co">#&gt; acceptance rates of delta: </span></a>
<a class="sourceLine" id="cb7-35" title="35"><span class="co">#&gt; [1] 17.8 23.1 23.4 19.3 20.4 19.1</span></a>
<a class="sourceLine" id="cb7-36" title="36"><span class="co">#&gt; acceptance rates of gamma: </span></a>
<a class="sourceLine" id="cb7-37" title="37"><span class="co">#&gt; [1] 17.8 23.1 23.4 19.3 20.4 19.1</span></a>
<a class="sourceLine" id="cb7-38" title="38"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-39" title="39"><span class="co">#&gt; An edge 1 -&gt; 3 is reversed to 3 -&gt; 1  </span></a>
<a class="sourceLine" id="cb7-40" title="40"><span class="co">#&gt; An edge 4 -&gt; 1 is deleted </span></a>
<a class="sourceLine" id="cb7-41" title="41"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-42" title="42"><span class="co">#&gt; iter= 2000 </span></a>
<a class="sourceLine" id="cb7-43" title="43"><span class="co">#&gt; acceptance rates of alpha: </span></a>
<a class="sourceLine" id="cb7-44" title="44"><span class="co">#&gt;       [,1]  [,2]  [,3]  [,4]  [,5]  [,6]</span></a>
<a class="sourceLine" id="cb7-45" title="45"><span class="co">#&gt; [1,]  0.00 27.60 25.00 12.35 10.30 26.80</span></a>
<a class="sourceLine" id="cb7-46" title="46"><span class="co">#&gt; [2,] 28.15  0.00 26.80 27.25 27.40  7.70</span></a>
<a class="sourceLine" id="cb7-47" title="47"><span class="co">#&gt; [3,] 21.85 17.90  0.00  8.20 26.45 28.50</span></a>
<a class="sourceLine" id="cb7-48" title="48"><span class="co">#&gt; [4,] 28.40 25.95 27.45  0.00 27.90 26.70</span></a>
<a class="sourceLine" id="cb7-49" title="49"><span class="co">#&gt; [5,] 27.60 12.95 28.80 27.15  0.00 27.15</span></a>
<a class="sourceLine" id="cb7-50" title="50"><span class="co">#&gt; [6,] 27.05 27.10 27.30 27.95 26.15  0.00</span></a>
<a class="sourceLine" id="cb7-51" title="51"><span class="co">#&gt; acceptance rates of beta: </span></a>
<a class="sourceLine" id="cb7-52" title="52"><span class="co">#&gt;       [,1]  [,2]  [,3]  [,4]  [,5]  [,6]</span></a>
<a class="sourceLine" id="cb7-53" title="53"><span class="co">#&gt; [1,]  0.00 28.35 25.25 11.65 12.55 25.10</span></a>
<a class="sourceLine" id="cb7-54" title="54"><span class="co">#&gt; [2,] 23.35  0.00 26.60 25.50 25.65  9.30</span></a>
<a class="sourceLine" id="cb7-55" title="55"><span class="co">#&gt; [3,] 24.15 21.40  0.00 13.00 26.10 25.25</span></a>
<a class="sourceLine" id="cb7-56" title="56"><span class="co">#&gt; [4,] 25.55 24.60 26.45  0.00 25.00 25.25</span></a>
<a class="sourceLine" id="cb7-57" title="57"><span class="co">#&gt; [5,] 24.50 13.85 24.65 24.20  0.00 25.65</span></a>
<a class="sourceLine" id="cb7-58" title="58"><span class="co">#&gt; [6,] 24.85 25.00 24.75 25.95 24.90  0.00</span></a>
<a class="sourceLine" id="cb7-59" title="59"><span class="co">#&gt; acceptance rates of delta: </span></a>
<a class="sourceLine" id="cb7-60" title="60"><span class="co">#&gt; [1] 19.10 23.20 23.65 19.15 20.90 19.30</span></a>
<a class="sourceLine" id="cb7-61" title="61"><span class="co">#&gt; acceptance rates of gamma: </span></a>
<a class="sourceLine" id="cb7-62" title="62"><span class="co">#&gt; [1] 19.10 23.20 23.65 19.15 20.90 19.30</span></a>
<a class="sourceLine" id="cb7-63" title="63"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-64" title="64"><span class="co">#&gt; An edge 6 -&gt; 1 is added </span></a>
<a class="sourceLine" id="cb7-65" title="65"><span class="co">#&gt; An edge 6 -&gt; 1 is deleted </span></a>
<a class="sourceLine" id="cb7-66" title="66"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-67" title="67"><span class="co">#&gt; iter= 3000 </span></a>
<a class="sourceLine" id="cb7-68" title="68"><span class="co">#&gt; acceptance rates of alpha: </span></a>
<a class="sourceLine" id="cb7-69" title="69"><span class="co">#&gt;       [,1]  [,2]  [,3]  [,4]  [,5]  [,6]</span></a>
<a class="sourceLine" id="cb7-70" title="70"><span class="co">#&gt; [1,]  0.00 30.00 22.70 19.80  9.97 28.23</span></a>
<a class="sourceLine" id="cb7-71" title="71"><span class="co">#&gt; [2,] 30.37  0.00 29.00 29.43 29.07  7.47</span></a>
<a class="sourceLine" id="cb7-72" title="72"><span class="co">#&gt; [3,] 24.50 17.87  0.00  8.47 28.97 30.23</span></a>
<a class="sourceLine" id="cb7-73" title="73"><span class="co">#&gt; [4,] 29.50 27.20 29.30  0.00 28.93 28.53</span></a>
<a class="sourceLine" id="cb7-74" title="74"><span class="co">#&gt; [5,] 29.83 13.00 29.57 28.90  0.00 30.00</span></a>
<a class="sourceLine" id="cb7-75" title="75"><span class="co">#&gt; [6,] 29.27 29.47 28.97 30.03 28.93  0.00</span></a>
<a class="sourceLine" id="cb7-76" title="76"><span class="co">#&gt; acceptance rates of beta: </span></a>
<a class="sourceLine" id="cb7-77" title="77"><span class="co">#&gt;       [,1]  [,2]  [,3]  [,4]  [,5]  [,6]</span></a>
<a class="sourceLine" id="cb7-78" title="78"><span class="co">#&gt; [1,]  0.00 26.80 25.77 15.77 12.57 24.10</span></a>
<a class="sourceLine" id="cb7-79" title="79"><span class="co">#&gt; [2,] 24.03  0.00 26.33 25.57 25.27  9.77</span></a>
<a class="sourceLine" id="cb7-80" title="80"><span class="co">#&gt; [3,] 24.00 20.60  0.00 12.93 25.70 25.53</span></a>
<a class="sourceLine" id="cb7-81" title="81"><span class="co">#&gt; [4,] 25.93 24.57 26.93  0.00 25.27 25.20</span></a>
<a class="sourceLine" id="cb7-82" title="82"><span class="co">#&gt; [5,] 24.27 13.80 24.43 24.90  0.00 24.97</span></a>
<a class="sourceLine" id="cb7-83" title="83"><span class="co">#&gt; [6,] 24.87 25.13 24.73 25.63 25.83  0.00</span></a>
<a class="sourceLine" id="cb7-84" title="84"><span class="co">#&gt; acceptance rates of delta: </span></a>
<a class="sourceLine" id="cb7-85" title="85"><span class="co">#&gt; [1] 19.60 21.83 23.50 19.07 20.43 19.60</span></a>
<a class="sourceLine" id="cb7-86" title="86"><span class="co">#&gt; acceptance rates of gamma: </span></a>
<a class="sourceLine" id="cb7-87" title="87"><span class="co">#&gt; [1] 19.60 21.83 23.50 19.07 20.43 19.60</span></a>
<a class="sourceLine" id="cb7-88" title="88"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-89" title="89"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-90" title="90"><span class="co">#&gt; iter= 4000 </span></a>
<a class="sourceLine" id="cb7-91" title="91"><span class="co">#&gt; acceptance rates of alpha: </span></a>
<a class="sourceLine" id="cb7-92" title="92"><span class="co">#&gt;       [,1]  [,2]  [,3]  [,4]  [,5]  [,6]</span></a>
<a class="sourceLine" id="cb7-93" title="93"><span class="co">#&gt; [1,]  0.00 29.88 21.73 22.07  9.60 28.75</span></a>
<a class="sourceLine" id="cb7-94" title="94"><span class="co">#&gt; [2,] 30.88  0.00 29.05 29.78 29.50  7.27</span></a>
<a class="sourceLine" id="cb7-95" title="95"><span class="co">#&gt; [3,] 25.75 18.07  0.00  8.38 29.40 30.68</span></a>
<a class="sourceLine" id="cb7-96" title="96"><span class="co">#&gt; [4,] 29.25 27.50 29.55  0.00 29.75 29.28</span></a>
<a class="sourceLine" id="cb7-97" title="97"><span class="co">#&gt; [5,] 30.23 12.90 29.33 29.55  0.00 30.18</span></a>
<a class="sourceLine" id="cb7-98" title="98"><span class="co">#&gt; [6,] 30.23 29.55 29.58 30.33 29.65  0.00</span></a>
<a class="sourceLine" id="cb7-99" title="99"><span class="co">#&gt; acceptance rates of beta: </span></a>
<a class="sourceLine" id="cb7-100" title="100"><span class="co">#&gt;       [,1]  [,2]  [,3] [,4]  [,5]  [,6]</span></a>
<a class="sourceLine" id="cb7-101" title="101"><span class="co">#&gt; [1,]  0.00 27.77 26.55 18.6 12.30 25.00</span></a>
<a class="sourceLine" id="cb7-102" title="102"><span class="co">#&gt; [2,] 24.75  0.00 26.40 25.8 25.80  9.68</span></a>
<a class="sourceLine" id="cb7-103" title="103"><span class="co">#&gt; [3,] 25.62 20.50  0.00 13.0 26.38 26.35</span></a>
<a class="sourceLine" id="cb7-104" title="104"><span class="co">#&gt; [4,] 26.85 24.77 27.57  0.0 26.52 25.97</span></a>
<a class="sourceLine" id="cb7-105" title="105"><span class="co">#&gt; [5,] 25.52 13.45 24.85 26.0  0.00 26.12</span></a>
<a class="sourceLine" id="cb7-106" title="106"><span class="co">#&gt; [6,] 26.15 25.82 25.50 26.1 26.50  0.00</span></a>
<a class="sourceLine" id="cb7-107" title="107"><span class="co">#&gt; acceptance rates of delta: </span></a>
<a class="sourceLine" id="cb7-108" title="108"><span class="co">#&gt; [1] 20.45 21.27 23.45 19.68 20.30 19.32</span></a>
<a class="sourceLine" id="cb7-109" title="109"><span class="co">#&gt; acceptance rates of gamma: </span></a>
<a class="sourceLine" id="cb7-110" title="110"><span class="co">#&gt; [1] 20.45 21.27 23.45 19.68 20.30 19.32</span></a>
<a class="sourceLine" id="cb7-111" title="111"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-112" title="112"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-113" title="113"><span class="co">#&gt; iter= 5000 </span></a>
<a class="sourceLine" id="cb7-114" title="114"><span class="co">#&gt; acceptance rates of alpha: </span></a>
<a class="sourceLine" id="cb7-115" title="115"><span class="co">#&gt;       [,1]  [,2]  [,3]  [,4]  [,5]  [,6]</span></a>
<a class="sourceLine" id="cb7-116" title="116"><span class="co">#&gt; [1,]  0.00 29.98 21.30 22.98  9.78 29.14</span></a>
<a class="sourceLine" id="cb7-117" title="117"><span class="co">#&gt; [2,] 31.14  0.00 29.40 29.66 29.92  7.32</span></a>
<a class="sourceLine" id="cb7-118" title="118"><span class="co">#&gt; [3,] 27.00 17.94  0.00  8.64 29.80 30.88</span></a>
<a class="sourceLine" id="cb7-119" title="119"><span class="co">#&gt; [4,] 29.56 27.52 29.18  0.00 29.62 29.48</span></a>
<a class="sourceLine" id="cb7-120" title="120"><span class="co">#&gt; [5,] 30.36 12.88 29.64 29.76  0.00 29.88</span></a>
<a class="sourceLine" id="cb7-121" title="121"><span class="co">#&gt; [6,] 30.28 30.00 28.92 30.06 29.24  0.00</span></a>
<a class="sourceLine" id="cb7-122" title="122"><span class="co">#&gt; acceptance rates of beta: </span></a>
<a class="sourceLine" id="cb7-123" title="123"><span class="co">#&gt;       [,1]  [,2]  [,3]  [,4]  [,5]  [,6]</span></a>
<a class="sourceLine" id="cb7-124" title="124"><span class="co">#&gt; [1,]  0.00 27.62 26.20 20.70 12.58 25.00</span></a>
<a class="sourceLine" id="cb7-125" title="125"><span class="co">#&gt; [2,] 25.46  0.00 26.56 26.24 25.54  9.88</span></a>
<a class="sourceLine" id="cb7-126" title="126"><span class="co">#&gt; [3,] 26.62 20.60  0.00 12.76 26.58 26.74</span></a>
<a class="sourceLine" id="cb7-127" title="127"><span class="co">#&gt; [4,] 26.56 25.70 27.16  0.00 26.96 25.84</span></a>
<a class="sourceLine" id="cb7-128" title="128"><span class="co">#&gt; [5,] 25.98 13.16 25.70 25.92  0.00 26.16</span></a>
<a class="sourceLine" id="cb7-129" title="129"><span class="co">#&gt; [6,] 26.16 25.92 25.52 25.64 26.52  0.00</span></a>
<a class="sourceLine" id="cb7-130" title="130"><span class="co">#&gt; acceptance rates of delta: </span></a>
<a class="sourceLine" id="cb7-131" title="131"><span class="co">#&gt; [1] 20.60 21.64 23.66 19.92 20.50 19.46</span></a>
<a class="sourceLine" id="cb7-132" title="132"><span class="co">#&gt; acceptance rates of gamma: </span></a>
<a class="sourceLine" id="cb7-133" title="133"><span class="co">#&gt; [1] 20.60 21.64 23.66 19.92 20.50 19.46</span></a></code></pre></div>
<p>We run the <code>mcmc_ZIPBN</code> function with the generated data in the previous section. <code>starting</code>, <code>tuning</code>, and <code>priors</code> are passed into the <code>mcmc_ZIPBN</code> function. <code>n_sample = 5000</code> and <code>n_burin = 2500</code> are specified to determine the number of MCMC iterations and burn-in samples.<br />
Since we set <code>verbose = TRUE</code> and <code>n_report = 1000</code>, progress of the MCMC sampler and Metropolis acceptance rates are reported every 1000th interation. Observe that the printed acceptance rates are between 25% and 60%, which indicates our MCMC sampler is tuned well.</p>
<p> </p>
</div>
<div id="posterior-inference-via-zipbn-results" class="section level1">
<h1>Posterior Inference via <code>ZIPBN</code> Results</h1>
<p>The <code>mcmc_ZIPBN</code> function returns MCMC samples from posterior distributions for the defined parameters of ZIPBN models as well as Metropolis acceptance percents. We are going to do posterior inference using the MCMC samples in this section.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="co"># report Metropolis sampling acceptance percents</span></a>
<a class="sourceLine" id="cb8-2" title="2">out<span class="op">$</span>acceptance</a>
<a class="sourceLine" id="cb8-3" title="3"><span class="co">#&gt; $alpha</span></a>
<a class="sourceLine" id="cb8-4" title="4"><span class="co">#&gt;       [,1]  [,2]  [,3]  [,4]  [,5]  [,6]</span></a>
<a class="sourceLine" id="cb8-5" title="5"><span class="co">#&gt; [1,]  0.00 29.98 21.30 22.98  9.78 29.14</span></a>
<a class="sourceLine" id="cb8-6" title="6"><span class="co">#&gt; [2,] 31.14  0.00 29.40 29.66 29.92  7.32</span></a>
<a class="sourceLine" id="cb8-7" title="7"><span class="co">#&gt; [3,] 27.00 17.94  0.00  8.64 29.80 30.88</span></a>
<a class="sourceLine" id="cb8-8" title="8"><span class="co">#&gt; [4,] 29.56 27.52 29.18  0.00 29.62 29.48</span></a>
<a class="sourceLine" id="cb8-9" title="9"><span class="co">#&gt; [5,] 30.36 12.88 29.64 29.76  0.00 29.88</span></a>
<a class="sourceLine" id="cb8-10" title="10"><span class="co">#&gt; [6,] 30.28 30.00 28.92 30.06 29.24  0.00</span></a>
<a class="sourceLine" id="cb8-11" title="11"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-12" title="12"><span class="co">#&gt; $beta</span></a>
<a class="sourceLine" id="cb8-13" title="13"><span class="co">#&gt;       [,1]  [,2]  [,3]  [,4]  [,5]  [,6]</span></a>
<a class="sourceLine" id="cb8-14" title="14"><span class="co">#&gt; [1,]  0.00 27.62 26.20 20.70 12.58 25.00</span></a>
<a class="sourceLine" id="cb8-15" title="15"><span class="co">#&gt; [2,] 25.46  0.00 26.56 26.24 25.54  9.88</span></a>
<a class="sourceLine" id="cb8-16" title="16"><span class="co">#&gt; [3,] 26.62 20.60  0.00 12.76 26.58 26.74</span></a>
<a class="sourceLine" id="cb8-17" title="17"><span class="co">#&gt; [4,] 26.56 25.70 27.16  0.00 26.96 25.84</span></a>
<a class="sourceLine" id="cb8-18" title="18"><span class="co">#&gt; [5,] 25.98 13.16 25.70 25.92  0.00 26.16</span></a>
<a class="sourceLine" id="cb8-19" title="19"><span class="co">#&gt; [6,] 26.16 25.92 25.52 25.64 26.52  0.00</span></a>
<a class="sourceLine" id="cb8-20" title="20"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-21" title="21"><span class="co">#&gt; $gamma</span></a>
<a class="sourceLine" id="cb8-22" title="22"><span class="co">#&gt; [1] 20.60 21.64 23.66 19.92 20.50 19.46</span></a>
<a class="sourceLine" id="cb8-23" title="23"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-24" title="24"><span class="co">#&gt; $delta</span></a>
<a class="sourceLine" id="cb8-25" title="25"><span class="co">#&gt; [1] 20.60 21.64 23.66 19.92 20.50 19.46</span></a></code></pre></div>
<p>The Metropolis sampling acceptance rates seems good, as mentioned in the previous section. We then make inference on graph structure.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="co"># recover garph structure</span></a>
<a class="sourceLine" id="cb9-2" title="2">cutoff =<span class="st"> </span><span class="fl">0.5</span></a>
<a class="sourceLine" id="cb9-3" title="3">A_est  =<span class="st"> </span><span class="dv">1</span> <span class="op">*</span><span class="st"> </span>(<span class="kw">apply</span>(out<span class="op">$</span>samples<span class="op">$</span>A, <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean) <span class="op">&gt;</span><span class="st"> </span>cutoff)</a>
<a class="sourceLine" id="cb9-4" title="4"></a>
<a class="sourceLine" id="cb9-5" title="5"><span class="co"># show the generated DAG</span></a>
<a class="sourceLine" id="cb9-6" title="6">A_est</a>
<a class="sourceLine" id="cb9-7" title="7"><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5] [,6]</span></a>
<a class="sourceLine" id="cb9-8" title="8"><span class="co">#&gt; [1,]    0    0    1    0    1    0</span></a>
<a class="sourceLine" id="cb9-9" title="9"><span class="co">#&gt; [2,]    0    0    0    0    0    1</span></a>
<a class="sourceLine" id="cb9-10" title="10"><span class="co">#&gt; [3,]    0    1    0    1    0    0</span></a>
<a class="sourceLine" id="cb9-11" title="11"><span class="co">#&gt; [4,]    0    0    0    0    0    0</span></a>
<a class="sourceLine" id="cb9-12" title="12"><span class="co">#&gt; [5,]    0    1    0    0    0    0</span></a>
<a class="sourceLine" id="cb9-13" title="13"><span class="co">#&gt; [6,]    0    0    0    0    0    0</span></a>
<a class="sourceLine" id="cb9-14" title="14">g_est =<span class="st"> </span><span class="kw">graph_from_adjacency_matrix</span>(<span class="kw">t</span>(A_est))</a>
<a class="sourceLine" id="cb9-15" title="15"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb9-16" title="16"><span class="kw">plot.igraph</span>(g, <span class="dt">vertex.size =</span> <span class="dv">25</span>, <span class="dt">vertex.color =</span> <span class="st">&quot;pink&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;True DAG&quot;</span>)</a>
<a class="sourceLine" id="cb9-17" title="17"><span class="kw">plot.igraph</span>(g_est, <span class="dt">vertex.size =</span> <span class="dv">25</span>, <span class="dt">vertex.color =</span> <span class="st">&quot;orange&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;DAG recovered using ZIPBN&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The posterior mean of each element <span class="math inline">\(a_{jk}\)</span> of <span class="math inline">\(A\)</span> represents probability that the edge <span class="math inline">\(k \to j\)</span> exists. To recover the graph, therefore, we need to set a cutoff to determine which edges are selected. Here, graph structure is recovered by applying the cutoff 0.5. We print the recovered adjacency matrix A_est. Its graph is also plotted with the graph of true DAG by using <code>plot.igraph</code> function. Notice that the underlying graph structure of true DAG is completely found by our estimate.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"><span class="co"># collect MCMC samples corresponding to the recovered graph</span></a>
<a class="sourceLine" id="cb10-2" title="2">subset =<span class="st"> </span><span class="kw">apply</span>(out<span class="op">$</span>samples<span class="op">$</span>A <span class="op">==</span><span class="st"> </span><span class="kw">array</span>(A_est, <span class="dt">dim =</span> <span class="kw">c</span>(p, p, n_sample <span class="op">-</span><span class="st"> </span>n_burnin)), <span class="dv">3</span>, all)</a>
<a class="sourceLine" id="cb10-3" title="3">alpha_mcmc =<span class="st"> </span>out<span class="op">$</span>samples<span class="op">$</span>alpha[ , , subset]</a>
<a class="sourceLine" id="cb10-4" title="4">beta_mcmc  =<span class="st"> </span>out<span class="op">$</span>samples<span class="op">$</span>beta[ , , subset]</a>
<a class="sourceLine" id="cb10-5" title="5">delta_mcmc =<span class="st"> </span>out<span class="op">$</span>samples<span class="op">$</span>delta[ , subset]</a>
<a class="sourceLine" id="cb10-6" title="6">gamma_mcmc =<span class="st"> </span>out<span class="op">$</span>samples<span class="op">$</span>gamma[ , subset]</a>
<a class="sourceLine" id="cb10-7" title="7"></a>
<a class="sourceLine" id="cb10-8" title="8"><span class="co"># calculate the posterior mean of each parameter, given the recovered graph </span></a>
<a class="sourceLine" id="cb10-9" title="9">alpha_est =<span class="st"> </span><span class="kw">apply</span>(alpha_mcmc, <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</a>
<a class="sourceLine" id="cb10-10" title="10">beta_est  =<span class="st"> </span><span class="kw">apply</span>(beta_mcmc, <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</a>
<a class="sourceLine" id="cb10-11" title="11">delta_est =<span class="st"> </span><span class="kw">rowMeans</span>(delta_mcmc)</a>
<a class="sourceLine" id="cb10-12" title="12">gamma_est =<span class="st"> </span><span class="kw">rowMeans</span>(gamma_mcmc)</a>
<a class="sourceLine" id="cb10-13" title="13"></a>
<a class="sourceLine" id="cb10-14" title="14"><span class="co"># report the posterior mean of each parameter</span></a>
<a class="sourceLine" id="cb10-15" title="15"><span class="kw">round</span>(alpha_est, <span class="dt">digits =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb10-16" title="16"><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5] [,6]</span></a>
<a class="sourceLine" id="cb10-17" title="17"><span class="co">#&gt; [1,]    0 0.00 0.26 0.00 0.21 0.00</span></a>
<a class="sourceLine" id="cb10-18" title="18"><span class="co">#&gt; [2,]    0 0.00 0.00 0.00 0.00 0.22</span></a>
<a class="sourceLine" id="cb10-19" title="19"><span class="co">#&gt; [3,]    0 0.23 0.00 0.21 0.00 0.00</span></a>
<a class="sourceLine" id="cb10-20" title="20"><span class="co">#&gt; [4,]    0 0.00 0.00 0.00 0.00 0.00</span></a>
<a class="sourceLine" id="cb10-21" title="21"><span class="co">#&gt; [5,]    0 0.22 0.00 0.00 0.00 0.00</span></a>
<a class="sourceLine" id="cb10-22" title="22"><span class="co">#&gt; [6,]    0 0.00 0.00 0.00 0.00 0.00</span></a>
<a class="sourceLine" id="cb10-23" title="23"><span class="kw">round</span>(beta_est, <span class="dt">digits =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb10-24" title="24"><span class="co">#&gt;      [,1]  [,2]  [,3]  [,4]  [,5]  [,6]</span></a>
<a class="sourceLine" id="cb10-25" title="25"><span class="co">#&gt; [1,]    0  0.00 -0.18  0.00 -0.18  0.00</span></a>
<a class="sourceLine" id="cb10-26" title="26"><span class="co">#&gt; [2,]    0  0.00  0.00  0.00  0.00 -0.21</span></a>
<a class="sourceLine" id="cb10-27" title="27"><span class="co">#&gt; [3,]    0 -0.19  0.00 -0.21  0.00  0.00</span></a>
<a class="sourceLine" id="cb10-28" title="28"><span class="co">#&gt; [4,]    0  0.00  0.00  0.00  0.00  0.00</span></a>
<a class="sourceLine" id="cb10-29" title="29"><span class="co">#&gt; [5,]    0 -0.21  0.00  0.00  0.00  0.00</span></a>
<a class="sourceLine" id="cb10-30" title="30"><span class="co">#&gt; [6,]    0  0.00  0.00  0.00  0.00  0.00</span></a>
<a class="sourceLine" id="cb10-31" title="31"><span class="kw">round</span>(delta_est, <span class="dt">digits =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb10-32" title="32"><span class="co">#&gt; [1] -0.93 -1.28 -1.28 -0.93 -1.12 -1.01</span></a>
<a class="sourceLine" id="cb10-33" title="33"><span class="kw">round</span>(gamma_est, <span class="dt">digits =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb10-34" title="34"><span class="co">#&gt; [1] 1.96 1.96 1.98 2.03 2.00 2.01</span></a></code></pre></div>
<p>Provided the estimated DAG, we continue posterior inference on other ZIPBN parameters. First thing we need to do is to collect MCMC samples which correspond to the recovered graph. Based on the subset of MCMC samples, the posterior mean of each parameter is calculated. Observe that our estimates fairly match with true values of parameters.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"><span class="co"># calculate the highest posterior density intervals for ZIPBN parameters</span></a>
<a class="sourceLine" id="cb11-2" title="2"><span class="kw">library</span>(HDInterval)</a>
<a class="sourceLine" id="cb11-3" title="3"><span class="kw">hdi</span>(alpha_mcmc[<span class="dv">1</span>, <span class="dv">3</span>, ], <span class="dt">credMass =</span> <span class="fl">0.95</span>)   <span class="co"># credible interval for \alpha_{13}</span></a>
<a class="sourceLine" id="cb11-4" title="4"><span class="co">#&gt;     lower     upper </span></a>
<a class="sourceLine" id="cb11-5" title="5"><span class="co">#&gt; 0.1995487 0.3571684 </span></a>
<a class="sourceLine" id="cb11-6" title="6"><span class="co">#&gt; attr(,&quot;credMass&quot;)</span></a>
<a class="sourceLine" id="cb11-7" title="7"><span class="co">#&gt; [1] 0.95</span></a>
<a class="sourceLine" id="cb11-8" title="8"><span class="kw">hdi</span>(beta_mcmc[<span class="dv">1</span>, <span class="dv">3</span>, ], <span class="dt">credMass =</span> <span class="fl">0.95</span>)    <span class="co"># credible interval for \beta_{13}</span></a>
<a class="sourceLine" id="cb11-9" title="9"><span class="co">#&gt;      lower      upper </span></a>
<a class="sourceLine" id="cb11-10" title="10"><span class="co">#&gt; -0.2321712 -0.1420238 </span></a>
<a class="sourceLine" id="cb11-11" title="11"><span class="co">#&gt; attr(,&quot;credMass&quot;)</span></a>
<a class="sourceLine" id="cb11-12" title="12"><span class="co">#&gt; [1] 0.95</span></a>
<a class="sourceLine" id="cb11-13" title="13"><span class="kw">hdi</span>(delta_mcmc[<span class="dv">1</span>, ], <span class="dt">credMass =</span> <span class="fl">0.95</span>)      <span class="co"># credible interval for \delta_{1}</span></a>
<a class="sourceLine" id="cb11-14" title="14"><span class="co">#&gt;      lower      upper </span></a>
<a class="sourceLine" id="cb11-15" title="15"><span class="co">#&gt; -1.1558605 -0.7445094 </span></a>
<a class="sourceLine" id="cb11-16" title="16"><span class="co">#&gt; attr(,&quot;credMass&quot;)</span></a>
<a class="sourceLine" id="cb11-17" title="17"><span class="co">#&gt; [1] 0.95</span></a>
<a class="sourceLine" id="cb11-18" title="18"><span class="kw">hdi</span>(gamma_mcmc[<span class="dv">1</span>, ], <span class="dt">credMass =</span> <span class="fl">0.95</span>)      <span class="co"># credible interval for \gamma_{1}</span></a>
<a class="sourceLine" id="cb11-19" title="19"><span class="co">#&gt;    lower    upper </span></a>
<a class="sourceLine" id="cb11-20" title="20"><span class="co">#&gt; 1.904136 2.003261 </span></a>
<a class="sourceLine" id="cb11-21" title="21"><span class="co">#&gt; attr(,&quot;credMass&quot;)</span></a>
<a class="sourceLine" id="cb11-22" title="22"><span class="co">#&gt; [1] 0.95</span></a></code></pre></div>
<p>In addition to point estimates, we are able to construct a credible interval for each parameter based on the posterior samples. The credible interval is a Bayesian alternative to the confidence interval. The package <code>HDInterval</code> calculates the highest posterior density intervals using samples from the posterior distribution. The highest posterior density interval is the credible interval with the shortest length. Here, we calculate 95% highest posterior density intervals for <span class="math inline">\(\alpha_{13}\)</span>, <span class="math inline">\(\beta_{13}\)</span>, <span class="math inline">\(\delta_1\)</span>, and <span class="math inline">\(\gamma_1\)</span>. All of the intervals contain the true parameter values.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
